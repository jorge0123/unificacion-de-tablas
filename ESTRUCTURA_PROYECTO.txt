```
ğŸ“ unificacion-de-tablas/
â”‚
â”œâ”€â”€ ğŸ“„ main.py                              â­ Script principal BATCH
â”œâ”€â”€ ğŸ“„ main-SERVER.py                       â­ Servidor Flask API REST
â”œâ”€â”€ ğŸ“„ test_api_gateway.py                  ğŸ§ª Suite de pruebas
â”œâ”€â”€ ğŸ“„ requirements.txt                     ğŸ“¦ Dependencias
â”œâ”€â”€ ğŸ“„ setup.sh                             âš™ï¸  Script de instalaciÃ³n
â”‚
â”œâ”€â”€ ğŸ“ config/                              ğŸ” ConfiguraciÃ³n
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ credentials.py                      âš ï¸  SECRETOS (no comitear)
â”‚
â”œâ”€â”€ ğŸ“ src/                                 ğŸ’» CÃ³digo fuente
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ api_gateway.py                      â­ Motor de sincronizaciÃ³n
â”‚   â”œâ”€â”€ database.py                         ğŸ—„ï¸  Gestor de BD
â”‚   â”œâ”€â”€ comparison.py                       ğŸ“Š ComparaciÃ³n de tablas
â”‚   â”œâ”€â”€ injection.py                        ğŸ’‰ InyecciÃ³n de datos
â”‚   â”œâ”€â”€ logger.py                           ğŸ“ Sistema de logging
â”‚   â””â”€â”€ api.py                              ğŸ”Œ API utilities
â”‚
â”œâ”€â”€ ğŸ“ logs/                                ğŸ“‹ Archivos de log
â”‚   â””â”€â”€ app.log                             (Creado automÃ¡ticamente)
â”‚
â”œâ”€â”€ ğŸ“ .venv/                               ğŸ Entorno virtual
â”‚
â”œâ”€â”€ ğŸ“š DOCUMENTACION COMPLETA
â”‚   â”œâ”€â”€ ğŸ“„ DOCUMENTACION_API_GATEWAY.md     ğŸ“– DocumentaciÃ³n tÃ©cnica
â”‚   â”œâ”€â”€ ğŸ“„ RESUMEN_IMPLEMENTACION.md        ğŸ“‹ Resumen de cambios
â”‚   â”œâ”€â”€ ğŸ“„ CONFIG_EJEMPLO.md                âš™ï¸  GuÃ­a de configuraciÃ³n
â”‚   â”œâ”€â”€ ğŸ“„ GUIA_RAPIDA.txt                  ğŸš€ Inicio rÃ¡pido
â”‚   â””â”€â”€ ğŸ“„ README.md                        (Proyecto original)
â”‚
â””â”€â”€ ğŸ“„ .gitignore                           ğŸ”’ Ignorar credenciales
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š MAPEO DE ARCHIVOS

EJECUCIÃ“N BATCH (Sin servidor)
â”œâ”€â”€ main.py                                 â† Punto de entrada
â”œâ”€â”€ src/api_gateway.py                      â† LÃ³gica principal
â””â”€â”€ config/credentials.py                   â† ConfiguraciÃ³n

SERVIDOR API REST
â”œâ”€â”€ main-SERVER.py                          â† Servidor Flask
â”œâ”€â”€ src/api_gateway.py                      â† LÃ³gica principal
â””â”€â”€ config/credentials.py                   â† ConfiguraciÃ³n

TESTING
â”œâ”€â”€ test_api_gateway.py                     â† Suite de pruebas
â”œâ”€â”€ main-SERVER.py                          â† Requiere servidor activo
â””â”€â”€ config/credentials.py                   â† ConfiguraciÃ³n

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”„ FLUJO DE DATOS

Entrada:
  â”œâ”€â”€ Batch Mode: Procesa todos los nodos configurados
  â””â”€â”€ REST API: GET /api/gateway/process?nodo=NODO1

Procesamiento (6 pasos en src/api_gateway.py):
  â”œâ”€â”€ PASO 1: Verificar actualizaciones recientes
  â”œâ”€â”€ PASO 2: Detectar cierres automÃ¡ticos
  â”œâ”€â”€ PASO 3: Sincronizar tabla automÃ¡tica (Bâ†’C)
  â”œâ”€â”€ PASO 4: Aplicar prioridad gestiÃ³n (Aâ†’C) â­
  â”œâ”€â”€ PASO 5: Volcado a fallas masivas (Câ†’Fallas)
  â””â”€â”€ PASO 6: Retornar datos

Salida:
  â”œâ”€â”€ JSON con tickets abiertos del nodo
  â””â”€â”€ Logs detallados en logs/app.log

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ ARCHIVOS CLAVES

â­ PRINCIPALES
  src/api_gateway.py       Motor de sincronizaciÃ³n (6 pasos)
  main.py                  Script batch
  main-SERVER.py           Servidor Flask

ğŸ—„ï¸  BASE DE DATOS
  src/database.py          Gestor de conexiones SQL Server

âš™ï¸  CONFIGURACIÃ“N
  config/credentials.py    Credenciales y tablas (NO COMITEAR)
  setup.sh                 Script de instalaciÃ³n

ğŸ“š DOCUMENTACIÃ“N
  DOCUMENTACION_API_GATEWAY.md     DocumentaciÃ³n tÃ©cnica completa
  GUIA_RAPIDA.txt                  Inicio rÃ¡pido
  RESUMEN_IMPLEMENTACION.md        Resumen de cambios

ğŸ§ª TESTING
  test_api_gateway.py      Suite de pruebas

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ INICIO RÃPIDO

1. InstalaciÃ³n:
   bash setup.sh

2. Configurar credenciales:
   nano config/credentials.py

3. Ejecutar:
   python main.py              (Batch)
   python main-SERVER.py       (Servidor)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¡ ENDPOINTS (Servidor)

GET /api/gateway/process?nodo=NODO1
  Ejecuta flujo completo de sincronizaciÃ³n

GET /api/gateway/status?nodo=NODO1
  EstadÃ­sticas del nodo

GET /api/gateway/health
  Verifica servidor activo

GET /api/gateway/nodes
  Lista nodos disponibles

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… LO QUE SE HIZO

âœ“ Convertido cÃ³digo PHP a Python moderno
âœ“ Implementado API Gateway con 6 pasos de sincronizaciÃ³n
âœ“ Creado servidor Flask REST con 4 endpoints
âœ“ Gestor seguro de conexiones SQL Server
âœ“ Soporte para esquemas personalizados (ej: schema.tabla)
âœ“ Sistema completo de logging
âœ“ Suite de testing incluida
âœ“ DocumentaciÃ³n completa (3 guÃ­as)
âœ“ Script de instalaciÃ³n automÃ¡tica
âœ“ ProtecciÃ³n de credenciales (.gitignore)
âœ“ ParÃ¡metros SQL preparados (sin inyecciÃ³n)
âœ“ Context managers para seguridad de conexiones

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ CHECKLIST PRE-PRODUCCIÃ“N

â–¡ Editar config/credentials.py con datos reales
â–¡ Ejecutar setup.sh
â–¡ Probar con: python main.py
â–¡ Verificar logs en logs/app.log
â–¡ Iniciar servidor: python main-SERVER.py
â–¡ Ejecutar pruebas: python test_api_gateway.py
â–¡ Verificar permisos en BD (UPDATE, INSERT, MERGE)
â–¡ Revisar tablas en BD
â–¡ Configurar cron job (si es necesario)
â–¡ Hacer test en producciÃ³n con datos reales

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Generado: 12 de febrero de 2026
VersiÃ³n: 1.0.0
```
